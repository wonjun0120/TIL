# 도메인 주도 설계로 시작하는 마이크로서비스 개발

## 02. MSA의 이해
- 리액티브 선언: 현대 애플리케이션이 갖춰야 할 바람직한 속성들
    - 리액티브 시스템 : 급변하는 상황에 적응할 수 있는 시스템
    - 아키텍처 유연성 - 시스템 구성요소 관계 느슨, 메시지 기반
- 강 결합에서 느슨한 결합의 아키텍처로의 변화
    - 벤더 종속 해결, 필요 영역에 적절한 솔루션을 선택하고 조합하는 개방적인 방식
    - https://landscape.cncf.io/
- 외부, 내부 아키텍처
    - p.28 아키텍처 구조 예시 사진
    - MSA 외부 아키텍처 : 인프라 영역, 플랫폼 영역, 애플리케이션 영역에 있는 구성요소 및 관계 정의
    - MSA 내부 아키텍처 : 비즈니스 실행되는 비즈니스 애플리케이션, 마이크로서비스 내부구조
- MSA 구성요소 및 패턴
    - 인프라 > 미들웨어(플랫폼) > 애플리케이션
    - 인프라 : 하드웨어, SW, 네트워킹 구성요소, 운영체제, 데이터 스토리지 등
        - Iaas, Paas, 베어 메탈
        - VM, 컨테이너
        - 컨테이너 오케스트레이션
    - 미들웨어(플랫폼) : 애플리케이션 운영, 관리 환경, 빌드, 배포
        - DevOps환경 : 개발과 운영이 분리되지 않은, 병행할 수 있는 조직 또는 문화
        - CI/CD
        - 마이크로서비스는 각 별도의 리포지토리 보유, 독립적 수정 및 빌드, 배포 필요, 빌드, 배포 파이프라인도 별도 설계
        - 스프링 클라우드 : 스프링 부트 + 넷플릭스 OSS, p.43 참고
        - 서비스 디스커버리 패턴 : 다양한 서비스 등록 및 탐색을 위한 서비스 레지스트리 사용
        - API 게이트웨이 패턴 : 서비스 단일 진입
        - BFF 패턴 : Backend for Frontend, 다양한 클라이언트를 고려, 클라이언트 특화 처리를 위한 API 조합이나 처리
        - 외부 구성 저장소 패턴 : 마이크로서비스가 사용하는 자원의 설정 정보를 쉽고 일관되게 변경 가능하도록 관리필요
        - 서킷 브레이커 패턴 : 한 서비스 장애 발생시 다른 서비스 영향 방지, 장애 발생 서비스 격리 방법
        - 중앙화된 로그 집계 패턴 : 로그 관리 패턴, 이벤트 스트림으로 처리, ELK스택
        - 서비스 메시 패턴 : 스프링 클라우드는 자바 기반, 자바 외에 다른 언어 문제, 이를 해결하기 위해 사용
            - 구글 이스티오, Istio
    - 애플리케이션 패턴
        -  프론트엔트 : 모노리식, 백엔드 : MSA
        -  UI 컴포지트 패턴 (마이크로 프론트엔드) : 프론트엔드도 기능별 분리, frame형태의 부모창을 통해 각 프론트엔드 조합
        -  마이크로서비스 통신 패턴 :
            - 동기 통신 방식 : REST API 호출
            - 비동기 통신 방식 : 메시지 기반, Kafka, RabbitMQ 같은 메시지 브로커 사용
        - 저장소 분리 패턴 : 모놀리식 -> 서비스는 한가, 통합 데이터베이스만 바쁨 / 저장소 분리
            - 각 마이크로서비스 각자의 비즈니스 처리하기 위한 데이터 직접 소유, 서비스를 거쳐 데이터 접근
        - 분산 트랜잭션 처리 패턴
            - 분산된 서비스를 하나의 일관된 트랜잭션으로 묶기
        - CQRS 패턴 : 명령 조회 책임 분리, 하나의 저장소에 쓰기 모델과 읽기 모델을 분리하는 방식, 서비스와 조회 서비스 분리
